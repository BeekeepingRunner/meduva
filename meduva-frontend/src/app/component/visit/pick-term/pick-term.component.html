<div *ngIf="loading">
  <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
</div>
<div *ngIf="!loading">
  <div *ngIf="canChooseTerm">
    <h3>Choose term for {{ selectedService?.name }}:</h3>
    <div>
      <mat-form-field appearance="fill">
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="picker" [matDatepickerFilter]="dateFilter" required>
        <mat-datepicker-toggle matSuffix [for]="picker"  (click)="onDatePickerClick()"></mat-datepicker-toggle>
        <mat-datepicker #picker [dateClass]="dayChecker" [calendarHeaderComponent]="asyncHeader"></mat-datepicker>
      </mat-form-field>

      <mat-progress-spinner *ngIf="generatingTerms" mode="indeterminate"></mat-progress-spinner>

      <div *ngIf="canSelectHour">
        <table mat-table [dataSource]="availableTerms" class="mat-elevation-z8">

          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let term"><b>{{ term.startTime | date: 'dd/MM/yyyy HH:mm' }}</b></td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; let term; columns: displayedColumns;"
              (click)="selectTerm(term)" >
          </tr>
        </table>
      </div>
    </div>
  </div>
  <div *ngIf="!canChooseTerm">
    Something went wrong, please try again later.
  </div>
</div>
